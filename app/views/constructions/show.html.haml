.row
  .col-xs-12
    = render partial: 'show_header', locals: {construction: @construction}
.row
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Contrato
          = number_to_currency(@construction.total_budget)
      %div{class: "panel-body"}
        %p
          Monto original:
          = number_to_currency(@construction.contract_amount)
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Extensiones:
          = number_to_currency(@construction.extensions_amount)
      %div{class: "panel-body"}
        %p
          Actualmente:
          = @construction.extensions.size
          = link_to "(ver todas)", extensions_path(construction_id: @construction)
        %p
        = link_to 'Agregar', new_extension_path(construction_id: @construction), class: 'pull-right'
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Estimaciones
          = number_to_currency(@construction.estimates_amount)
      %div{class: "panel-body"}
        %p
          Actualmente:
          = @construction.estimates.size
          = link_to "(ver todas)", estimates_path(construction_id: @construction)
        %p
          = link_to "Agregar", new_estimate_path(construction_id: @construction), class: 'pull-right'

.row
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Caja chica 
      %div{class: "panel-body"}
        %p
          = link_to '(ver todas)', petty_cashes_path(construction_id: @construction)
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Requisiciones 
      %div{class: "panel-body"}
        %p
          Procesadas:
          = @construction.partial_requisitions.size + @construction.complete_requisitions.size
          = link_to "(ver todas)", requisitions_path(construction_id: @construction)
        %p
          Pendientes:
          = @construction.pending_requisitions.count
  .col-md-4.col-xs-12
    %div{class: "panel panel-default"}
      %div{class: "panel-heading"}
        %h4{class: "panel-title"}
          Ordenes de compra 
      %div{class: "panel-body"}
        %p
          Facturadas:
          = @construction.invoiced_purchases_orders.size
          = link_to "(ver todas)", purchase_orders_path(construction_id: @construction)
        %p
          Sin facturar:
          = @construction.uninvoiced_purchases_orders.size

- unless current_user.secretary?
  .row
    .col-md-4.col-xs-12
      %div{class: "panel panel-default"}
        %div{class: "panel-heading"}
          %h4{class: "panel-title"}
            Gastos
        %div{class: "panel-body"}
          %p
            Total:
            = number_to_currency(@construction.expenses)
          %p
            Pagado:
            = number_to_currency(@construction.paid)
          %p
            Saldo:
            = number_to_currency(@construction.expenses - @construction.paid)
          %p
            %a{onclick: "window.createPayment(#{@construction ? @construction.id : @office.id})", class: 'pull-right', style: 'cursor: pointer;'}
              Agregar

= render partial: 'payments_part'
#billing
